<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Discord Webhook Sender</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', system-ui, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100%;
            position: relative;
            overflow-x: hidden;
        }
        
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }
        
        .star.small {
            width: 1px;
            height: 1px;
            animation-duration: 2s;
        }
        
        .star.medium {
            width: 2px;
            height: 2px;
            animation-duration: 3s;
        }
        
        .star.large {
            width: 3px;
            height: 3px;
            animation-duration: 4s;
        }
        
        .star.moving {
            animation: moveAcross 15s linear infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        @keyframes moveAcross {
            0% { transform: translateX(-100px) translateY(0px); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateX(calc(100vw + 100px)) translateY(-50px); opacity: 0; }
        }
        
        @keyframes slideInUp {
            0% { transform: translateY(30px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes slideInLeft {
            0% { transform: translateX(-30px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideInRight {
            0% { transform: translateX(30px); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.3); }
            50% { box-shadow: 0 0 30px rgba(102, 126, 234, 0.6); }
        }
        
        .animate-slide-up {
            animation: slideInUp 0.6s ease-out;
        }
        
        .animate-slide-left {
            animation: slideInLeft 0.6s ease-out;
        }
        
        .animate-slide-right {
            animation: slideInRight 0.6s ease-out;
        }
        
        .animate-pulse-slow {
            animation: pulse 3s ease-in-out infinite;
        }
        
        .animate-glow {
            animation: glow 2s ease-in-out infinite;
        }
        
        .content-wrapper {
            position: relative;
            z-index: 1;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .glass-dark {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        .section-spacing {
            margin-bottom: 2rem;
        }
        
        .input-group {
            margin-bottom: 1.5rem;
        }
        
        .professional-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(240, 147, 251, 0.3);
        }
        
        .tab-active {
            background: rgba(255, 255, 255, 0.2);
            border-bottom: 2px solid #667eea;
        }
        
        .preview-message {
            background: #36393f;
            border-left: 4px solid #7289da;
        }
        
        .embed-preview {
            background: #2f3136;
            border-left: 4px solid;
        }
        
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            animation: slideIn 0.3s ease-out;
        }
        
        .notification.success { background: #10b981; }
        .notification.error { background: #ef4444; }
        .notification.info { background: #3b82f6; }
        
        @keyframes slideIn {
            0% { transform: translateX(100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        .file-drop-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .file-drop-zone.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        
        .color-picker-wrapper {
            position: relative;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .color-picker-wrapper input[type="color"] {
            position: absolute;
            width: 100%;
            height: 100%;
            border: none;
            cursor: pointer;
        }
        
        .webhook-status {
            margin-top: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .webhook-status.valid {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981;
        }
        
        .webhook-status.invalid {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }
        
        .webhook-status.checking {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #3b82f6;
        }
        
        .status-icon {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .channel-selector {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.12);
            transition: all 0.3s ease;
        }
        
        .channel-selector:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-2px);
        }
        
        .channel-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .channel-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .channel-item.active {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        
        .channel-form {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .floating-button {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 100;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }
        
        .floating-button:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }
        
        .modal-overlay {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
        }
        
        .modal-content {
            background: rgba(15, 15, 35, 0.95);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .gradient-border {
            position: relative;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border: 1px solid transparent;
        }
        
        .gradient-border::before {
            content: '';
            position: absolute;
            inset: 0;
            padding: 1px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: inherit;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="min-h-full text-white"><!-- Animated Stars Background -->
  <div class="stars" id="stars-container"></div>
  <div class="content-wrapper professional-container"><!-- Header -->
   <div class="text-center section-spacing animate-slide-up">
    <h1 id="app-title" class="text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">Discord Webhook Manager</h1>
   </div><!-- Channel Management Section -->
   <div class="glass rounded-2xl p-6 section-spacing animate-slide-left">
    <div class="flex items-center justify-between mb-6">
     <h2 class="text-2xl font-bold text-white/90 flex items-center gap-3">
      <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
       <svg width="16" height="16" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V8C22 6.89543 21.1046 6 20 6H12L10 4Z" fill="white" />
       </svg>
      </div> Channel Manager <span id="channel-count" class="text-sm bg-blue-500/20 px-3 py-1 rounded-full">0 channels</span></h2><button id="add-channel-btn" class="btn-primary px-4 py-2 rounded-xl font-medium flex items-center gap-2 hover:scale-105 transition-transform">
      <div class="w-5 h-5 bg-white/20 rounded-md flex items-center justify-center">
       <svg width="12" height="12" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 5V19M5 12H19" stroke="white" stroke-width="2" stroke-linecap="round" />
       </svg>
      </div> Add Channel </button>
    </div>
    <div id="channels-container" class="space-y-3">
     <div class="text-center py-8 text-white/60">
      <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-gray-600 to-gray-800 rounded-xl flex items-center justify-center">
       <svg width="32" height="32" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="6" width="20" height="12" rx="2" stroke="white" stroke-width="1.5" fill="none" /> <path d="M7 2L9 6M17 2L15 6" stroke="white" stroke-width="1.5" stroke-linecap="round" /> <circle cx="12" cy="12" r="2" fill="white" />
       </svg>
      </div>
      <p class="text-lg">No channels configured yet</p>
      <p class="text-sm">Add your first channel to get started!</p>
     </div>
    </div>
   </div><!-- Main Container -->
   <div class="glass rounded-2xl p-8 section-spacing animate-slide-right gradient-border"><!-- Current Channel Display -->
    <div class="input-group">
     <div class="flex items-center justify-between mb-3"><label class="block text-sm font-medium text-white/90">Current Channel</label>
      <div id="current-channel-display" class="flex items-center gap-2 px-3 py-1 bg-blue-500/20 rounded-lg">
       <div class="w-5 h-5 bg-blue-500/30 rounded flex items-center justify-center">
        <svg width="12" height="12" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="6" width="20" height="12" rx="2" stroke="#60a5fa" stroke-width="1.5" fill="none" /> <circle cx="12" cy="12" r="1.5" fill="#60a5fa" />
        </svg>
       </div><span id="current-channel-name" class="text-sm font-medium text-blue-300">No channel selected</span>
      </div>
     </div><input type="url" id="webhook-url" class="w-full px-4 py-4 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500 transition-all animate-glow" placeholder="Select a channel or enter webhook URL manually..." readonly>
     <p class="text-xs text-white/60 mt-2">💡 Select a channel above or add a new one to manage webhooks</p><!-- Webhook Status Indicator -->
     <div id="webhook-status" class="webhook-status" style="display: none;">
      <div class="status-icon">
       <div class="loading-spinner w-4 h-4 border-2 border-current border-t-transparent rounded-full"></div>
      </div><span>Checking webhook...</span>
     </div>
    </div><!-- Webhook Customization -->
    <div class="input-group">
     <h3 class="text-lg font-semibold mb-4 text-white/90 flex items-center gap-3">
      <div class="w-6 h-6 bg-gradient-to-br from-green-500 to-blue-600 rounded-lg flex items-center justify-center">
       <svg width="14" height="14" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="6" y="8" width="12" height="10" rx="2" fill="white" /> <circle cx="9" cy="11" r="1" fill="currentColor" /> <circle cx="15" cy="11" r="1" fill="currentColor" /> <path d="M9 14H15" stroke="currentColor" stroke-width="1" stroke-linecap="round" /> <path d="M12 8V6M12 6C12 4.89543 11.1046 4 10 4H8C6.89543 4 6 4.89543 6 6V8M12 6C12 4.89543 12.8954 4 14 4H16C17.1046 4 18 4.89543 18 6V8" stroke="white" stroke-width="1.5" stroke-linecap="round" />
       </svg>
      </div> Bot Customization</h3>
     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div><label class="block text-sm font-medium mb-3 text-white/90">Bot Username</label> <input type="text" id="bot-username" class="w-full px-4 py-4 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500 transition-all" placeholder="My Bot">
      </div>
      <div><label class="block text-sm font-medium mb-3 text-white/90">Bot Avatar URL</label> <input type="url" id="bot-avatar" class="w-full px-4 py-4 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500 transition-all" placeholder="https://example.com/avatar.png">
      </div>
     </div>
    </div><!-- Message Type Tabs -->
    <div class="input-group">
     <h3 class="text-lg font-semibold mb-4 text-white/90 flex items-center gap-3">
      <div class="w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center">
       <svg width="14" height="14" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 9H16M8 13H14M6 20L3 17V7C3 5.89543 3.89543 5 5 5H19C20.1046 5 21 5.89543 21 7V15C21 16.1046 20.1046 17 19 17H9L6 20Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
       </svg>
      </div> Message Type</h3>
     <div class="flex space-x-2 glass-dark rounded-xl p-2"><button id="tab-simple" class="tab-btn flex-1 py-3 px-6 rounded-lg text-sm font-medium transition-all tab-active flex items-center justify-center gap-2">
       <div class="w-4 h-4 bg-white/20 rounded flex items-center justify-center">
        <svg width="10" height="10" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 12H16M8 8H16M6 20L3 17V7C3 5.89543 3.89543 5 5 5H19C20.1046 5 21 5.89543 21 7V15C21 16.1046 20.1046 17 19 17H9L6 20Z" stroke="white" stroke-width="1.5" />
        </svg>
       </div> Simple Message </button> <button id="tab-embed" class="tab-btn flex-1 py-3 px-6 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2">
       <div class="w-4 h-4 bg-white/20 rounded flex items-center justify-center">
        <svg width="10" height="10" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="5" width="18" height="14" rx="2" stroke="white" stroke-width="1.5" fill="none" /> <path d="M7 9H17M7 13H13" stroke="white" stroke-width="1.5" stroke-linecap="round" />
        </svg>
       </div> Rich Embed </button> <button id="tab-file" class="tab-btn flex-1 py-3 px-6 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2">
       <div class="w-4 h-4 bg-white/20 rounded flex items-center justify-center">
        <svg width="10" height="10" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" stroke="white" stroke-width="1.5" /> <path d="M14 2V8H20" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
       </div> File Upload </button>
     </div>
    </div><!-- Simple Message Tab -->
    <div id="simple-tab" class="tab-content">
     <div class="input-group"><label class="block text-sm font-medium mb-3 text-white/90">Message Content</label> <textarea id="simple-message" rows="6" class="w-full px-4 py-4 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500 resize-none transition-all" placeholder="Type your message here... You can use Discord markdown!"></textarea>
      <div class="flex justify-between items-center mt-3">
       <p class="text-xs text-white/60">Supports **bold**, *italic*, `code`, and more Discord formatting</p><span id="char-count" class="text-xs text-white/60 font-mono">0/2000</span>
      </div>
     </div>
    </div><!-- Embed Tab -->
    <div id="embed-tab" class="tab-content hidden"><!-- Live Preview at Top -->
     <div class="mb-6">
      <div class="flex items-center gap-3 mb-3">
       <div class="w-6 h-6 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg flex items-center justify-center">
        <svg width="14" height="14" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z" stroke="white" stroke-width="1.5" /> <circle cx="12" cy="12" r="3" stroke="white" stroke-width="1.5" />
        </svg>
       </div><label class="text-lg font-semibold text-white/90">Live Preview</label>
      </div>
      <div class="glass-dark rounded-xl p-4 sticky top-4 z-10">
       <div id="embed-preview" class="embed-preview rounded-lg p-4">
        <div class="text-gray-400 text-center py-8">
         <div class="w-12 h-12 mx-auto mb-3 bg-gradient-to-br from-gray-600 to-gray-800 rounded-lg flex items-center justify-center">
          <svg width="24" height="24" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z" stroke="white" stroke-width="1.5" /> <circle cx="12" cy="12" r="3" stroke="white" stroke-width="1.5" />
          </svg>
         </div>
         <p>Fill in the form to see preview</p>
        </div>
       </div>
      </div>
     </div>
     <div class="grid grid-cols-1 lg:grid-cols-2 gap-6"><!-- Embed Form -->
      <div class="space-y-4">
       <div><label class="block text-sm font-medium mb-2">Embed Title</label> <input type="text" id="embed-title" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500" placeholder="Embed Title">
       </div>
       <div><label class="block text-sm font-medium mb-2">Description</label> <textarea id="embed-description" rows="3" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500 resize-none" placeholder="Embed description..."></textarea>
       </div>
       <div class="grid grid-cols-2 gap-4">
        <div><label class="block text-sm font-medium mb-2">Color</label>
         <div class="color-picker-wrapper glass-dark"><input type="color" id="embed-color" value="#667eea">
         </div>
        </div>
        <div><label class="block text-sm font-medium mb-2">Timestamp</label> <label class="flex items-center space-x-2"> <input type="checkbox" id="embed-timestamp" class="rounded"> <span class="text-sm">Add current time</span> </label>
        </div>
       </div>
       <div><label class="block text-sm font-medium mb-2">Image URL</label> <input type="url" id="embed-image" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://example.com/image.png">
       </div>
       <div><label class="block text-sm font-medium mb-2">Thumbnail URL</label> <input type="url" id="embed-thumbnail" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://example.com/thumb.png">
       </div>
       <div class="grid grid-cols-2 gap-4">
        <div><label class="block text-sm font-medium mb-2">Author Name</label> <input type="text" id="embed-author" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500" placeholder="Author">
        </div>
        <div><label class="block text-sm font-medium mb-2">Footer Text</label> <input type="text" id="embed-footer" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500" placeholder="Footer">
        </div>
       </div><!-- Fields -->
       <div>
        <div class="flex items-center justify-between mb-2"><label class="block text-sm font-medium">Fields</label> <button id="add-field" class="btn-secondary px-3 py-1 rounded-lg text-xs">+ Add Field</button>
        </div>
        <div id="embed-fields" class="space-y-2"></div>
       </div>
      </div>
     </div>
    </div><!-- File Upload Tab -->
    <div id="file-tab" class="tab-content hidden">
     <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div>
       <div class="mb-4"><label class="block text-sm font-medium mb-2">Message (Optional)</label> <textarea id="file-message" rows="3" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500 resize-none" placeholder="Optional message with your file..."></textarea>
       </div>
       <div class="file-drop-zone rounded-xl p-8 text-center" id="file-drop-zone">
        <div class="mb-4">
         <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-orange-500 to-red-600 rounded-xl flex items-center justify-center">
          <svg width="32" height="32" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.44 11.05L12.25 20.24C11.1242 21.3658 9.59722 22.0001 8.005 22.0001C6.41278 22.0001 4.88583 21.3658 3.76 20.24C2.63417 19.1142 1.99994 17.5872 1.99994 15.995C1.99994 14.4028 2.63417 12.8758 3.76 11.75L12.33 3.18C13.1055 2.40447 14.1477 1.96821 15.235 1.96821C16.3223 1.96821 17.3645 2.40447 18.14 3.18C18.9155 3.95553 19.3518 4.99775 19.3518 6.085C19.3518 7.17225 18.9155 8.21447 18.14 8.99L10.28 16.85C9.89247 17.2375 9.37123 17.4554 8.825 17.4554C8.27877 17.4554 7.75753 17.2375 7.37 16.85C6.98247 16.4625 6.76458 15.9412 6.76458 15.395C6.76458 14.8488 6.98247 14.3275 7.37 13.94L15.07 6.24" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
         </div>
         <p class="text-lg font-medium mb-2">Drop files here or click to browse</p>
         <p class="text-sm text-white/60">Supports images, videos, documents, and more</p>
         <p class="text-xs text-white/50 mt-1">Max file size: 8MB per file</p>
        </div><input type="file" id="file-input" multiple class="hidden" accept="*/*"> <button id="browse-files" class="btn-primary px-6 py-3 rounded-xl font-medium flex items-center gap-2 cursor-pointer relative z-30" style="pointer-events: auto;">
         <div class="w-5 h-5 bg-white/20 rounded flex items-center justify-center">
          <svg width="12" height="12" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V8C22 6.89543 21.1046 6 20 6H12L10 4Z" fill="white" />
          </svg>
         </div> Browse Files </button>
       </div>
       <div id="selected-files" class="mt-4 space-y-2"></div>
      </div>
      <div><label class="block text-sm font-medium mb-2">File Preview</label>
       <div class="glass-dark rounded-xl p-4 h-64 overflow-y-auto">
        <div id="file-preview" class="text-gray-400 text-center py-8">
         <div class="w-12 h-12 mx-auto mb-3 bg-gradient-to-br from-gray-600 to-gray-800 rounded-lg flex items-center justify-center">
          <svg width="24" height="24" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" stroke="white" stroke-width="1.5" /> <path d="M14 2V8H20" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" /> <path d="M8 13H16M8 17H13" stroke="white" stroke-width="1.5" stroke-linecap="round" />
          </svg>
         </div>
         <p>Select files to see preview</p>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Send Button -->
    <div class="flex justify-center mt-8 pt-6 border-t border-white/10 relative z-20"><button id="send-btn" class="btn-primary px-12 py-4 rounded-xl font-semibold text-white text-lg shadow-lg hover:shadow-xl transition-all flex items-center gap-3 cursor-pointer relative z-30" style="pointer-events: auto;">
      <div class="w-6 h-6 bg-white/20 rounded-lg flex items-center justify-center">
       <svg width="16" height="16" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 16.5C3 15 3 12.5 3 12.5S3 10 4.5 8.5L12 1L19.5 8.5C21 10 21 12.5 21 12.5S21 15 19.5 16.5L12 24L4.5 16.5Z" fill="white" /> <path d="M12 8V16M8 12H16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
       </svg>
      </div><span id="send-button-text">Send Message</span> </button>
    </div>
   </div>
  </div><!-- Add Channel Modal -->
  <div id="channel-modal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
   <div class="modal-content rounded-2xl p-6 w-full max-w-md animate-slide-up">
    <div class="flex items-center justify-between mb-6">
     <h3 class="text-xl font-bold text-white flex items-center gap-3">
      <div class="w-6 h-6 bg-gradient-to-br from-green-500 to-blue-600 rounded-lg flex items-center justify-center">
       <svg width="14" height="14" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 5V19M5 12H19" stroke="white" stroke-width="2" stroke-linecap="round" />
       </svg>
      </div> Add New Channel</h3><button id="close-modal" class="text-white/60 hover:text-white text-2xl">×</button>
    </div>
    <form id="channel-form" class="space-y-4">
     <div><label class="block text-sm font-medium mb-2 text-white/90">Channel Name</label> <input type="text" id="channel-name-input" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., #general, #announcements" required>
     </div>
     <div><label class="block text-sm font-medium mb-2 text-white/90">Webhook URL</label> <input type="url" id="channel-webhook-input" class="w-full px-4 py-3 glass-dark rounded-xl text-white placeholder-gray-400 border-none outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://discord.com/api/webhooks/..." required>
      <p class="text-xs text-white/60 mt-1">Get this from Discord: Server Settings → Integrations → Webhooks</p>
     </div>
     <div class="flex gap-3 pt-4"><button type="button" id="cancel-channel" class="flex-1 px-4 py-3 glass-dark rounded-xl text-white hover:bg-white/10 transition-all"> Cancel </button> <button type="submit" class="flex-1 btn-primary px-4 py-3 rounded-xl text-white font-medium"> Add Channel </button>
     </div>
    </form>
   </div>
  </div><!-- Delete Confirmation Modal -->
  <div id="delete-modal" class="fixed inset-0 modal-overlay hidden z-50 flex items-center justify-center p-4">
   <div class="modal-content rounded-2xl p-6 w-full max-w-md animate-slide-up">
    <div class="text-center">
     <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-red-500 to-pink-600 rounded-xl flex items-center justify-center">
      <svg width="32" height="32" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 6H5H21M8 6V4C8 3.44772 8.44772 3 9 3H15C15.5523 3 16 3.44772 16 4V6M19 6V20C19 20.5523 18.5523 21 18 21H6C5.44772 21 5 20.5523 5 20V6H19ZM10 11V17M14 11V17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
     </div>
     <h3 class="text-xl font-bold text-white mb-2">Delete Channel</h3>
     <p class="text-white/70 mb-6">Are you sure you want to delete "<span id="delete-channel-name"></span>"? This action cannot be undone.</p>
     <div class="flex gap-3"><button id="cancel-delete" class="flex-1 px-4 py-3 glass-dark rounded-xl text-white hover:bg-white/10 transition-all"> Cancel </button> <button id="confirm-delete" class="flex-1 bg-red-500 hover:bg-red-600 px-4 py-3 rounded-xl text-white font-medium transition-all"> Delete </button>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Configuration
        const defaultConfig = {
            app_title: "🚀 Discord Webhook Manager",
            send_button_text: "🚀 Send Message"
        };

        let selectedFiles = [];
        let embedFields = [];
        let currentTab = 'simple';
        let channels = [];
        let currentChannelId = null;
        let channelToDelete = null;

        // Data SDK Handler
        const dataHandler = {
            onDataChanged(data) {
                channels = data;
                renderChannels();
                updateChannelCount();
            }
        };

        // Initialize SDKs
        async function initializeSDKs() {
            // Initialize Data SDK
            if (window.dataSdk) {
                const result = await window.dataSdk.init(dataHandler);
                if (!result.isOk) {
                    console.error("Failed to initialize Data SDK");
                }
            }

            // Initialize Element SDK
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    onConfigChange: async (config) => {
                        // Update text content
                        document.getElementById('app-title').textContent = config.app_title || defaultConfig.app_title;
                        document.getElementById('send-button-text').textContent = config.send_button_text || defaultConfig.send_button_text;
                        
                        // Apply font customization
                        const customFont = config.font_family || 'Inter';
                        const baseSize = config.font_size || 16;
                        const baseFontStack = 'Inter, system-ui, sans-serif';
                        
                        document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
                        document.documentElement.style.fontSize = `${baseSize}px`;
                        
                        // Apply colors
                        const primaryColor = config.primary_color || "#667eea";
                        const surfaceColor = config.surface_color || "rgba(255, 255, 255, 0.1)";
                        const textColor = config.text_color || "#ffffff";
                        
                        document.documentElement.style.setProperty('--primary-color', primaryColor);
                        document.documentElement.style.setProperty('--surface-color', surfaceColor);
                        document.documentElement.style.setProperty('--text-color', textColor);
                    },
                    mapToCapabilities: (config) => ({
                        recolorables: [
                            {
                                get: () => config.primary_color || "#667eea",
                                set: (value) => {
                                    config.primary_color = value;
                                    window.elementSdk.setConfig({ primary_color: value });
                                }
                            },
                            {
                                get: () => config.surface_color || "rgba(255, 255, 255, 0.1)",
                                set: (value) => {
                                    config.surface_color = value;
                                    window.elementSdk.setConfig({ surface_color: value });
                                }
                            },
                            {
                                get: () => config.text_color || "#ffffff",
                                set: (value) => {
                                    config.text_color = value;
                                    window.elementSdk.setConfig({ text_color: value });
                                }
                            }
                        ],
                        borderables: [],
                        fontEditable: {
                            get: () => config.font_family || "Inter",
                            set: (value) => {
                                config.font_family = value;
                                window.elementSdk.setConfig({ font_family: value });
                            }
                        },
                        fontSizeable: {
                            get: () => config.font_size || 16,
                            set: (value) => {
                                config.font_size = value;
                                window.elementSdk.setConfig({ font_size: value });
                            }
                        }
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ["app_title", config.app_title || defaultConfig.app_title],
                        ["send_button_text", config.send_button_text || defaultConfig.send_button_text]
                    ])
                });
            }
        }

        // Initialize app
        async function initializeApp() {
            await initializeSDKs();
            setupEventListeners();
            updateCharCount();
            updateEmbedPreview();
            createStars();
        }

        // Channel Management Functions
        function renderChannels() {
            const container = document.getElementById('channels-container');
            
            if (channels.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8 text-white/60 animate-slide-up">
                        <div class="text-4xl mb-3">📺</div>
                        <p class="text-lg">No channels configured yet</p>
                        <p class="text-sm">Add your first channel to get started!</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = channels.map(channel => `
                <div class="channel-item rounded-xl p-4 flex items-center justify-between ${currentChannelId === channel.__backendId ? 'active' : ''}" 
                     data-channel-id="${channel.__backendId}">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center text-white font-bold">
                            ${channel.name.charAt(0).toUpperCase()}
                        </div>
                        <div>
                            <div class="font-medium text-white">${escapeHtml(channel.name)}</div>
                            <div class="text-xs text-white/60">Added ${new Date(channel.created_at).toLocaleDateString()}</div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button class="select-channel-btn px-3 py-1 bg-blue-500/20 hover:bg-blue-500/30 rounded-lg text-blue-300 text-sm transition-all">
                            Select
                        </button>
                        <button class="delete-channel-btn text-red-400 hover:text-red-300 p-2 rounded-lg hover:bg-red-500/10 transition-all" 
                                data-channel-name="${escapeHtml(channel.name)}">
                            🗑️
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners to channel items
            container.querySelectorAll('.select-channel-btn').forEach((btn, index) => {
                btn.addEventListener('click', () => selectChannel(channels[index]));
            });
            
            container.querySelectorAll('.delete-channel-btn').forEach((btn, index) => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    showDeleteModal(channels[index]);
                });
            });
        }

        function updateChannelCount() {
            document.getElementById('channel-count').textContent = `${channels.length} channel${channels.length !== 1 ? 's' : ''}`;
        }

        function selectChannel(channel) {
            currentChannelId = channel.__backendId;
            document.getElementById('webhook-url').value = channel.webhook_url;
            document.getElementById('current-channel-name').textContent = channel.name;
            document.getElementById('webhook-url').removeAttribute('readonly');
            
            // Update active state
            document.querySelectorAll('.channel-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-channel-id="${channel.__backendId}"]`).classList.add('active');
            
            // Check webhook
            checkWebhookUrl();
            
            showNotification(`Selected channel: ${channel.name}`, 'success');
        }

        async function addChannel(name, webhookUrl) {
            if (channels.length >= 999) {
                showNotification('Maximum limit of 999 channels reached. Please delete some channels first.', 'error');
                return;
            }

            const channelData = {
                id: Date.now().toString(),
                name: name,
                webhook_url: webhookUrl,
                created_at: new Date().toISOString()
            };
            
            const result = await window.dataSdk.create(channelData);
            if (result.isOk) {
                showNotification(`✅ Channel "${name}" added successfully!`, 'success');
                closeModal();
            } else {
                showNotification('❌ Failed to add channel', 'error');
            }
        }

        async function deleteChannel(channel) {
            const result = await window.dataSdk.delete(channel);
            if (result.isOk) {
                if (currentChannelId === channel.__backendId) {
                    currentChannelId = null;
                    document.getElementById('webhook-url').value = '';
                    document.getElementById('current-channel-name').textContent = 'No channel selected';
                    document.getElementById('webhook-url').setAttribute('readonly', '');
                    document.getElementById('webhook-status').style.display = 'none';
                }
                showNotification(`🗑️ Channel "${channel.name}" deleted`, 'info');
                closeDeleteModal();
            } else {
                showNotification('❌ Failed to delete channel', 'error');
            }
        }

        // Modal Management
        function showModal() {
            document.getElementById('channel-modal').classList.remove('hidden');
            document.getElementById('channel-name-input').focus();
        }

        function closeModal() {
            document.getElementById('channel-modal').classList.add('hidden');
            document.getElementById('channel-form').reset();
        }

        function showDeleteModal(channel) {
            channelToDelete = channel;
            document.getElementById('delete-channel-name').textContent = channel.name;
            document.getElementById('delete-modal').classList.remove('hidden');
        }

        function closeDeleteModal() {
            document.getElementById('delete-modal').classList.add('hidden');
            channelToDelete = null;
        }

        // Setup event listeners
        function setupEventListeners() {
            // Wait for DOM to be ready, then attach listeners
            setTimeout(() => {
                // Direct button event listeners for better reliability
                
                // Send button - most important one
                const sendBtn = document.getElementById('send-btn');
                console.log('Send button found:', sendBtn); // Debug log
                if (sendBtn) {
                    // Remove any existing listeners first
                    sendBtn.onclick = null;
                    
                    // Add multiple event types for maximum compatibility
                    sendBtn.addEventListener('click', handleSendClick, true);
                    sendBtn.addEventListener('mousedown', handleSendClick, true);
                    sendBtn.onclick = handleSendClick;
                    
                    console.log('Send button listeners attached'); // Debug log
                } else {
                    console.error('Send button not found!');
                }
            }, 100);
            
            function handleSendClick(e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('Send button clicked!'); // Debug log
                sendMessage();
                return false;
            }
            
            // Add channel button
            const addChannelBtn = document.getElementById('add-channel-btn');
            if (addChannelBtn) {
                addChannelBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    showModal();
                });
            }
            
            // Browse files button - multiple event handlers for reliability
            const browseBtn = document.getElementById('browse-files');
            console.log('Browse files button found:', browseBtn); // Debug log
            if (browseBtn) {
                // Remove any existing listeners first
                browseBtn.onclick = null;
                
                // Add multiple event types for maximum compatibility
                browseBtn.addEventListener('click', handleBrowseClick, true);
                browseBtn.addEventListener('mousedown', handleBrowseClick, true);
                browseBtn.onclick = handleBrowseClick;
                
                console.log('Browse files button listeners attached'); // Debug log
            } else {
                console.error('Browse files button not found!');
            }
            
            function handleBrowseClick(e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('Browse files button clicked!'); // Debug log
                document.getElementById('file-input').click();
                return false;
            }
            
            // Add field button
            const addFieldBtn = document.getElementById('add-field');
            if (addFieldBtn) {
                addFieldBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    addEmbedField();
                });
            }
            
            // Tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    const tabId = btn.id.replace('tab-', '');
                    switchTab(tabId);
                });
            });
            
            // Modal buttons
            const closeModalBtn = document.getElementById('close-modal');
            if (closeModalBtn) {
                closeModalBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    closeModal();
                });
            }
            
            const cancelChannelBtn = document.getElementById('cancel-channel');
            if (cancelChannelBtn) {
                cancelChannelBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    closeModal();
                });
            }
            
            const cancelDeleteBtn = document.getElementById('cancel-delete');
            if (cancelDeleteBtn) {
                cancelDeleteBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    closeDeleteModal();
                });
            }
            
            const confirmDeleteBtn = document.getElementById('confirm-delete');
            if (confirmDeleteBtn) {
                confirmDeleteBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    if (channelToDelete) {
                        deleteChannel(channelToDelete);
                    }
                });
            }
            
            // Event delegation for dynamic content
            document.addEventListener('click', (e) => {
                const target = e.target;
                
                // Select channel buttons
                if (target.classList.contains('select-channel-btn')) {
                    e.preventDefault();
                    e.stopPropagation();
                    const channelItem = target.closest('.channel-item');
                    const channelId = channelItem.dataset.channelId;
                    const channel = channels.find(c => c.__backendId === channelId);
                    if (channel) {
                        selectChannel(channel);
                    }
                    return;
                }
                
                // Delete channel buttons
                if (target.classList.contains('delete-channel-btn')) {
                    e.preventDefault();
                    e.stopPropagation();
                    const channelItem = target.closest('.channel-item');
                    const channelId = channelItem.dataset.channelId;
                    const channel = channels.find(c => c.__backendId === channelId);
                    if (channel) {
                        showDeleteModal(channel);
                    }
                    return;
                }
                
                // Remove field buttons
                if (target.classList.contains('remove-field')) {
                    e.preventDefault();
                    e.stopPropagation();
                    const fieldElement = target.closest('.field-item');
                    fieldElement.remove();
                    updateEmbedFields();
                    return;
                }
                
                // Modal background clicks
                if (target.id === 'channel-modal') {
                    closeModal();
                    return;
                }
                
                if (target.id === 'delete-modal') {
                    closeDeleteModal();
                    return;
                }
            });
            
            // Form submissions
            document.getElementById('channel-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('channel-name-input').value.trim();
                const webhookUrl = document.getElementById('channel-webhook-input').value.trim();
                
                if (!name || !webhookUrl) {
                    showNotification('Please fill in all fields', 'error');
                    return;
                }
                
                if (!webhookUrl.includes('discord.com/api/webhooks/')) {
                    showNotification('Please enter a valid Discord webhook URL', 'error');
                    return;
                }
                
                await addChannel(name, webhookUrl);
            });

            // Character count for simple message
            document.getElementById('simple-message').addEventListener('input', updateCharCount);

            // Embed form inputs
            const embedInputs = ['embed-title', 'embed-description', 'embed-color', 'embed-image', 'embed-thumbnail', 'embed-author', 'embed-footer'];
            embedInputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', updateEmbedPreview);
                }
            });
            
            const timestampElement = document.getElementById('embed-timestamp');
            if (timestampElement) {
                timestampElement.addEventListener('change', updateEmbedPreview);
            }
            
            // File input
            document.getElementById('file-input').addEventListener('change', handleFileSelect);
            
            // File drop zone
            const dropZone = document.getElementById('file-drop-zone');
            if (dropZone) {
                dropZone.addEventListener('dragover', handleDragOver);
                dropZone.addEventListener('dragleave', handleDragLeave);
                dropZone.addEventListener('drop', handleFileDrop);
            }
            
            // Webhook URL validation (only when not readonly)
            document.getElementById('webhook-url').addEventListener('input', debounce(() => {
                if (!document.getElementById('webhook-url').hasAttribute('readonly')) {
                    checkWebhookUrl();
                }
            }, 500));
        }

        // Tab switching
        function switchTab(tabName) {
            currentTab = tabName;
            
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('tab-active');
            });
            document.getElementById(`tab-${tabName}`).classList.add('tab-active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
        }

        // Character count
        function updateCharCount() {
            const message = document.getElementById('simple-message').value;
            const count = message.length;
            document.getElementById('char-count').textContent = `${count}/2000`;
            
            if (count > 2000) {
                document.getElementById('char-count').classList.add('text-red-400');
            } else {
                document.getElementById('char-count').classList.remove('text-red-400');
            }
        }

        // Embed preview
        function updateEmbedPreview() {
            const title = document.getElementById('embed-title').value;
            const description = document.getElementById('embed-description').value;
            const color = document.getElementById('embed-color').value;
            const image = document.getElementById('embed-image').value;
            const thumbnail = document.getElementById('embed-thumbnail').value;
            const author = document.getElementById('embed-author').value;
            const footer = document.getElementById('embed-footer').value;
            const timestamp = document.getElementById('embed-timestamp').checked;
            
            const preview = document.getElementById('embed-preview');
            
            if (!title && !description && !author && !footer && !image && !thumbnail && embedFields.length === 0) {
                preview.innerHTML = `
                    <div class="text-gray-400 text-center py-8">
                        <div class="text-2xl mb-2">👁️</div>
                        <p>Fill in the form to see preview</p>
                    </div>
                `;
                return;
            }
            
            preview.style.borderLeftColor = color;
            
            let html = '<div class="space-y-3">';
            
            if (author) {
                html += `<div class="flex items-center space-x-2">
                    <div class="w-6 h-6 bg-gray-600 rounded-full"></div>
                    <span class="text-sm font-medium text-white">${escapeHtml(author)}</span>
                </div>`;
            }
            
            if (title) {
                html += `<div class="text-lg font-semibold text-blue-400">${escapeHtml(title)}</div>`;
            }
            
            if (description) {
                html += `<div class="text-gray-300 text-sm">${escapeHtml(description)}</div>`;
            }
            
            if (embedFields.length > 0) {
                html += '<div class="grid grid-cols-1 gap-2">';
                embedFields.forEach(field => {
                    html += `<div class="${field.inline ? 'inline-block' : 'block'}">
                        <div class="text-sm font-medium text-white">${escapeHtml(field.name)}</div>
                        <div class="text-sm text-gray-300">${escapeHtml(field.value)}</div>
                    </div>`;
                });
                html += '</div>';
            }
            
            if (image) {
                html += `<img src="${escapeHtml(image)}" class="max-w-full h-auto rounded" onerror="this.style.display='none'">`;
            }
            
            if (thumbnail) {
                html += `<div class="flex justify-end">
                    <img src="${escapeHtml(thumbnail)}" class="w-20 h-20 object-cover rounded" onerror="this.style.display='none'">
                </div>`;
            }
            
            if (footer || timestamp) {
                html += '<div class="flex items-center justify-between text-xs text-gray-400 pt-2 border-t border-gray-600">';
                if (footer) {
                    html += `<span>${escapeHtml(footer)}</span>`;
                }
                if (timestamp) {
                    html += `<span>${new Date().toLocaleString()}</span>`;
                }
                html += '</div>';
            }
            
            html += '</div>';
            preview.innerHTML = html;
        }

        // Add embed field
        function addEmbedField() {
            const fieldId = Date.now();
            const fieldHtml = `
                <div class="glass-dark rounded-lg p-3 field-item" data-field-id="${fieldId}">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-2 mb-2">
                        <input type="text" placeholder="Field Name" class="field-name px-3 py-2 glass rounded-lg text-white placeholder-gray-400 border-none outline-none text-sm">
                        <input type="text" placeholder="Field Value" class="field-value px-3 py-2 glass rounded-lg text-white placeholder-gray-400 border-none outline-none text-sm">
                        <div class="flex items-center space-x-2">
                            <label class="flex items-center space-x-1 text-sm">
                                <input type="checkbox" class="field-inline rounded">
                                <span>Inline</span>
                            </label>
                            <button class="remove-field text-red-400 hover:text-red-300 text-sm">🗑️</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('embed-fields').insertAdjacentHTML('beforeend', fieldHtml);
            
            const fieldElement = document.querySelector(`[data-field-id="${fieldId}"]`);
            fieldElement.querySelector('.field-name').addEventListener('input', updateEmbedFields);
            fieldElement.querySelector('.field-value').addEventListener('input', updateEmbedFields);
            fieldElement.querySelector('.field-inline').addEventListener('change', updateEmbedFields);
            fieldElement.querySelector('.remove-field').addEventListener('click', () => {
                fieldElement.remove();
                updateEmbedFields();
            });
            
            updateEmbedFields();
        }

        // Update embed fields
        function updateEmbedFields() {
            embedFields = [];
            document.querySelectorAll('.field-item').forEach(item => {
                const name = item.querySelector('.field-name').value.trim();
                const value = item.querySelector('.field-value').value.trim();
                const inline = item.querySelector('.field-inline').checked;
                
                if (name && value) {
                    embedFields.push({ name, value, inline });
                }
            });
            updateEmbedPreview();
        }

        // File handling
        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            addFiles(files);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
        }

        function handleFileDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files);
            addFiles(files);
        }

        function addFiles(files) {
            // Filter files by size (8MB limit)
            const validFiles = files.filter(file => {
                if (file.size > 8 * 1024 * 1024) {
                    showNotification(`File "${file.name}" is too large (max 8MB)`, 'error');
                    return false;
                }
                return true;
            });
            
            selectedFiles = [...selectedFiles, ...validFiles];
            updateFilePreview();
        }

        function updateFilePreview() {
            const container = document.getElementById('selected-files');
            const preview = document.getElementById('file-preview');
            
            if (selectedFiles.length === 0) {
                container.innerHTML = '';
                preview.innerHTML = `
                    <div class="text-gray-400 text-center py-8">
                        <div class="text-2xl mb-2">📄</div>
                        <p>Select files to see preview</p>
                    </div>
                `;
                return;
            }
            
            // Selected files list
            container.innerHTML = selectedFiles.map((file, index) => `
                <div class="glass-dark rounded-lg p-3 flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">${getFileIcon(file.type)}</span>
                        <div>
                            <div class="text-sm font-medium">${escapeHtml(file.name)}</div>
                            <div class="text-xs text-gray-400">${formatFileSize(file.size)}</div>
                        </div>
                    </div>
                    <button onclick="removeFile(${index})" class="text-red-400 hover:text-red-300">🗑️</button>
                </div>
            `).join('');
            
            // File preview
            const previewHtml = selectedFiles.map(file => {
                if (file.type.startsWith('image/')) {
                    const url = URL.createObjectURL(file);
                    return `<img src="${url}" class="max-w-full h-auto rounded mb-2" style="max-height: 200px;">`;
                } else {
                    return `
                        <div class="glass rounded-lg p-3 mb-2 flex items-center space-x-3">
                            <span class="text-2xl">${getFileIcon(file.type)}</span>
                            <div>
                                <div class="text-sm font-medium">${escapeHtml(file.name)}</div>
                                <div class="text-xs text-gray-400">${formatFileSize(file.size)}</div>
                            </div>
                        </div>
                    `;
                }
            }).join('');
            
            preview.innerHTML = previewHtml || `
                <div class="text-gray-400 text-center py-8">
                    <div class="text-2xl mb-2">📄</div>
                    <p>No preview available</p>
                </div>
            `;
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFilePreview();
        }

        function getFileIcon(mimeType) {
            if (mimeType.startsWith('image/')) return '🖼️';
            if (mimeType.startsWith('video/')) return '🎥';
            if (mimeType.startsWith('audio/')) return '🎵';
            if (mimeType.includes('pdf')) return '📄';
            if (mimeType.includes('text')) return '📝';
            if (mimeType.includes('zip') || mimeType.includes('rar')) return '📦';
            return '📎';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Send message
        async function sendMessage() {
            const webhookUrl = document.getElementById('webhook-url').value.trim();
            
            if (!webhookUrl) {
                showNotification('Please select a channel or enter a webhook URL', 'error');
                return;
            }
            
            if (!webhookUrl.includes('discord.com/api/webhooks/')) {
                showNotification('Please enter a valid Discord webhook URL', 'error');
                return;
            }
            
            const button = document.getElementById('send-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner w-4 h-4 border-2 border-white border-t-transparent rounded-full inline-block mr-2"></div>Sending...';
            button.disabled = true;
            
            try {
                let payload = {};
                
                // Bot customization
                const username = document.getElementById('bot-username').value.trim();
                const avatarUrl = document.getElementById('bot-avatar').value.trim();
                
                if (username) payload.username = username;
                if (avatarUrl) payload.avatar_url = avatarUrl;
                
                if (currentTab === 'simple') {
                    const message = document.getElementById('simple-message').value.trim();
                    if (!message) {
                        showNotification('Please enter a message', 'error');
                        return;
                    }
                    if (message.length > 2000) {
                        showNotification('Message is too long (max 2000 characters)', 'error');
                        return;
                    }
                    payload.content = message;
                    
                } else if (currentTab === 'embed') {
                    const embed = buildEmbed();
                    if (!embed) {
                        showNotification('Please fill in at least one embed field', 'error');
                        return;
                    }
                    payload.embeds = [embed];
                    
                } else if (currentTab === 'file') {
                    if (selectedFiles.length === 0) {
                        showNotification('Please select at least one file', 'error');
                        return;
                    }
                    
                    const fileMessage = document.getElementById('file-message').value.trim();
                    if (fileMessage) payload.content = fileMessage;
                    
                    // Handle file upload
                    await sendFileMessage(webhookUrl, payload, selectedFiles);
                    return;
                }
                
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload)
                });
                
                if (response.ok) {
                    showNotification('🎉 Message sent successfully!', 'success');
                    if (currentTab === 'simple') {
                        document.getElementById('simple-message').value = '';
                        updateCharCount();
                    }
                } else {
                    const errorText = await response.text();
                    showNotification(`Failed to send message: ${response.status}`, 'error');
                }
                
            } catch (error) {
                showNotification(`Network error: ${error.message}`, 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // Build embed object
        function buildEmbed() {
            const title = document.getElementById('embed-title').value.trim();
            const description = document.getElementById('embed-description').value.trim();
            const color = document.getElementById('embed-color').value;
            const image = document.getElementById('embed-image').value.trim();
            const thumbnail = document.getElementById('embed-thumbnail').value.trim();
            const author = document.getElementById('embed-author').value.trim();
            const footer = document.getElementById('embed-footer').value.trim();
            const timestamp = document.getElementById('embed-timestamp').checked;
            
            if (!title && !description && !author && !footer && !image && !thumbnail && embedFields.length === 0) {
                return null;
            }
            
            const embed = {};
            
            if (title) embed.title = title;
            if (description) embed.description = description;
            if (color) embed.color = parseInt(color.replace('#', ''), 16);
            if (image) embed.image = { url: image };
            if (thumbnail) embed.thumbnail = { url: thumbnail };
            if (author) embed.author = { name: author };
            if (footer) embed.footer = { text: footer };
            if (timestamp) embed.timestamp = new Date().toISOString();
            if (embedFields.length > 0) embed.fields = embedFields;
            
            return embed;
        }

        // Send file message
        async function sendFileMessage(webhookUrl, payload, files) {
            const formData = new FormData();
            
            // Add JSON payload
            formData.append('payload_json', JSON.stringify(payload));
            
            // Add files
            files.forEach((file, index) => {
                formData.append(`file${index}`, file);
            });
            
            const response = await fetch(webhookUrl, {
                method: 'POST',
                body: formData
            });
            
            if (response.ok) {
                showNotification('🎉 Files sent successfully!', 'success');
                selectedFiles = [];
                document.getElementById('file-message').value = '';
                document.getElementById('file-input').value = '';
                updateFilePreview();
            } else {
                throw new Error(`HTTP ${response.status}`);
            }
        }

        // Test webhook
        async function testWebhook() {
            const webhookUrl = document.getElementById('webhook-url').value.trim();
            
            if (!webhookUrl) {
                showNotification('Please enter a webhook URL first', 'error');
                return;
            }
            
            const testPayload = {
                content: '🧪 Test message from Discord Webhook Sender!',
                embeds: [{
                    title: 'Webhook Test',
                    description: 'This is a test message to verify your webhook is working correctly.',
                    color: 0x00ff00,
                    timestamp: new Date().toISOString(),
                    footer: { text: 'Test completed successfully' }
                }]
            };
            
            try {
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testPayload)
                });
                
                if (response.ok) {
                    showNotification('✅ Webhook test successful!', 'success');
                } else {
                    showNotification(`❌ Webhook test failed: ${response.status}`, 'error');
                }
            } catch (error) {
                showNotification(`❌ Test failed: ${error.message}`, 'error');
            }
        }

        // Clear form
        function clearForm() {
            document.getElementById('simple-message').value = '';
            document.getElementById('embed-title').value = '';
            document.getElementById('embed-description').value = '';
            document.getElementById('embed-color').value = '#667eea';
            document.getElementById('embed-image').value = '';
            document.getElementById('embed-thumbnail').value = '';
            document.getElementById('embed-author').value = '';
            document.getElementById('embed-footer').value = '';
            document.getElementById('embed-timestamp').checked = false;
            document.getElementById('file-message').value = '';
            document.getElementById('file-input').value = '';
            
            selectedFiles = [];
            embedFields = [];
            document.getElementById('embed-fields').innerHTML = '';
            
            updateCharCount();
            updateEmbedPreview();
            updateFilePreview();
            
            showNotification('🗑️ Form cleared', 'info');
        }

        // Save template
        function saveTemplate() {
            const template = {
                tab: currentTab,
                webhook_url: document.getElementById('webhook-url').value,
                bot_username: document.getElementById('bot-username').value,
                bot_avatar: document.getElementById('bot-avatar').value,
                simple_message: document.getElementById('simple-message').value,
                embed: {
                    title: document.getElementById('embed-title').value,
                    description: document.getElementById('embed-description').value,
                    color: document.getElementById('embed-color').value,
                    image: document.getElementById('embed-image').value,
                    thumbnail: document.getElementById('embed-thumbnail').value,
                    author: document.getElementById('embed-author').value,
                    footer: document.getElementById('embed-footer').value,
                    timestamp: document.getElementById('embed-timestamp').checked,
                    fields: embedFields
                },
                file_message: document.getElementById('file-message').value
            };
            
            const blob = new Blob([JSON.stringify(template, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `webhook-template-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('💾 Template saved!', 'success');
        }

        // Load template
        function loadTemplate() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                try {
                    const text = await file.text();
                    const template = JSON.parse(text);
                    
                    // Load template data
                    if (template.webhook_url) document.getElementById('webhook-url').value = template.webhook_url;
                    if (template.bot_username) document.getElementById('bot-username').value = template.bot_username;
                    if (template.bot_avatar) document.getElementById('bot-avatar').value = template.bot_avatar;
                    if (template.simple_message) document.getElementById('simple-message').value = template.simple_message;
                    if (template.file_message) document.getElementById('file-message').value = template.file_message;
                    
                    if (template.embed) {
                        const embed = template.embed;
                        if (embed.title) document.getElementById('embed-title').value = embed.title;
                        if (embed.description) document.getElementById('embed-description').value = embed.description;
                        if (embed.color) document.getElementById('embed-color').value = embed.color;
                        if (embed.image) document.getElementById('embed-image').value = embed.image;
                        if (embed.thumbnail) document.getElementById('embed-thumbnail').value = embed.thumbnail;
                        if (embed.author) document.getElementById('embed-author').value = embed.author;
                        if (embed.footer) document.getElementById('embed-footer').value = embed.footer;
                        document.getElementById('embed-timestamp').checked = embed.timestamp || false;
                        
                        if (embed.fields) {
                            embedFields = embed.fields;
                            document.getElementById('embed-fields').innerHTML = '';
                            embed.fields.forEach(() => addEmbedField());
                            
                            // Fill field values
                            const fieldItems = document.querySelectorAll('.field-item');
                            embed.fields.forEach((field, index) => {
                                if (fieldItems[index]) {
                                    fieldItems[index].querySelector('.field-name').value = field.name;
                                    fieldItems[index].querySelector('.field-value').value = field.value;
                                    fieldItems[index].querySelector('.field-inline').checked = field.inline;
                                }
                            });
                        }
                    }
                    
                    if (template.tab) {
                        switchTab(template.tab);
                    }
                    
                    updateCharCount();
                    updateEmbedPreview();
                    
                    showNotification('📂 Template loaded successfully!', 'success');
                } catch (error) {
                    showNotification('❌ Failed to load template', 'error');
                }
            };
            input.click();
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Webhook URL checker
        async function checkWebhookUrl() {
            const webhookUrl = document.getElementById('webhook-url').value.trim();
            const statusDiv = document.getElementById('webhook-status');
            
            if (!webhookUrl) {
                statusDiv.style.display = 'none';
                return;
            }
            
            // Show checking status
            statusDiv.style.display = 'flex';
            statusDiv.className = 'webhook-status checking';
            statusDiv.innerHTML = `
                <div class="status-icon">
                    <div class="loading-spinner w-4 h-4 border-2 border-current border-t-transparent rounded-full"></div>
                </div>
                <span>Checking webhook...</span>
            `;
            
            // Basic URL validation
            if (!webhookUrl.includes('discord.com/api/webhooks/')) {
                statusDiv.className = 'webhook-status invalid';
                statusDiv.innerHTML = `
                    <div class="status-icon">❌</div>
                    <span>Invalid webhook URL format</span>
                `;
                return;
            }
            
            try {
                // Test webhook with a HEAD request
                const response = await fetch(webhookUrl, {
                    method: 'GET'
                });
                
                if (response.ok) {
                    statusDiv.className = 'webhook-status valid';
                    statusDiv.innerHTML = `
                        <div class="status-icon">✅</div>
                        <span>Valid webhook - Ready to send messages</span>
                    `;
                } else if (response.status === 404) {
                    statusDiv.className = 'webhook-status invalid';
                    statusDiv.innerHTML = `
                        <div class="status-icon">❌</div>
                        <span>Webhook not found or deleted</span>
                    `;
                } else {
                    statusDiv.className = 'webhook-status invalid';
                    statusDiv.innerHTML = `
                        <div class="status-icon">⚠️</div>
                        <span>Webhook error (${response.status})</span>
                    `;
                }
            } catch (error) {
                statusDiv.className = 'webhook-status invalid';
                statusDiv.innerHTML = `
                    <div class="status-icon">❌</div>
                    <span>Unable to verify webhook</span>
                `;
            }
        }
        
        // Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Create animated stars
        function createStars() {
            const starsContainer = document.getElementById('stars-container');
            const starCount = 150;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // Random size
                const sizes = ['small', 'medium', 'large'];
                const size = sizes[Math.floor(Math.random() * sizes.length)];
                star.classList.add(size);
                
                // Random position
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                
                // Random animation delay
                star.style.animationDelay = Math.random() * 3 + 's';
                
                // Some stars move across screen
                if (Math.random() < 0.1) {
                    star.classList.add('moving');
                    star.style.animationDelay = Math.random() * 15 + 's';
                }
                
                starsContainer.appendChild(star);
            }
        }

        // Utility function
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Initialize the app
        initializeApp();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'997286e36288fdbc',t:'MTc2MTkwNzE0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
